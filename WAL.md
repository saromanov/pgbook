**Введение**

WAL(Write-Ahead-Log) - журнал для контроля целостности данных. Его можно использовать для восстановления данных после сбоя и для улучшения надежности. Реальный случай, когда восстановление данных моет потребоваться - это не завершенные операции в связи со сбоем. Мы начали записывать данные, произошел сбой(выключение сервера), часть данных пропала(оказалось не записанной). После возобновления работы, postgresql сначала попытается найти .wal файл и завершить прерванную операцию.
Каждое изменение с базой данных записывается в WAL, а потом уже в data файл.
[Описание](https://postgrespro.ru/docs/postgresql/12/wal-intro) WAL в PostgresPro

**Формат записи**
Формат записи в WAL отличается от обычного SQL запроса. Например, добавляем новые данные 

```sql
INSERT INTO album (title, cover, tracks) VALUES ('Postgres', '/etc/cover', 12);
```
В WAL представлении это будет выглядеть как
```
Header Info : crc,
RM_HEAP_ID, Xid,len,
XLOG_HEAP_INSERT
Data : tupleid, infobits,
c0: 'Postgres'
c1: '/etc/cover'
c2: 12
```
***

Отключение WAL позволяет выиграть производительность в угоду надежности. Отдельно, можно отключить WAL для некоторых таблиц

```sql
CREATE UNLOGGED TABLE album (
  id uuid PRIMARY KEY,
  title text,
  cover string
);
```

Стоит сказать, что UNLOGGED таблицы не поддерживают GiST индексы.
